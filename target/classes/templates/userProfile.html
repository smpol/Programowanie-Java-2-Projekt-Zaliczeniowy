<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="#{userprofile.title}"></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>
<body class="container py-4">
<h1 th:text="#{userprofile.title}"></h1>
<div th:if="${profile != null}" class="mb-4">
    <p th:text="#{userprofile.name} + ': ' + (${profile.firstName} ?: 'Brak danych')"></p>
    <p th:text="#{userprofile.surname} + ': ' + (${profile.lastName} ?: 'Brak danych')"></p>
    <p th:text="#{userprofile.email} + ': ' + (${profile.email} ?: 'Brak danych')"></p>
    <p th:text="#{userprofile.phone} + ': ' + (${profile.phoneNumber} ?: 'Brak danych')"></p>
</div>


<h2 th:text="#{userprofile.updateTitle}"></h2>
<form action="/user/updateProfile" method="post" class="needs-validation" novalidate>
    <input type="hidden" name="_csrf" th:value="${_csrf.token}"/>

    <div class="mb-3">
        <label for="firstName" class="form-label" th:text="#{userprofile.name}"></label>
        <input type="text" class="form-control" id="firstName" name="firstName"
               th:placeholder="#{userprofile.nameplease}"
               th:value="${profile.firstName}" required>
        <div class="invalid-feedback" th:text="#{userprofile.nameAlert}"></div>
    </div>
    <div class="mb-3">
        <label for="lastName" class="form-label" th:text="#{userprofile.surname}"></label>
        <input type="text" class="form-control" id="lastName" name="lastName"
               th:placeholder="#{userprofile.surnameplease}"
               th:value="${profile.lastName}" required>
        <div class="invalid-feedback" th:text="#{userprofile.surnameAlert}"></div>
    </div>
    <div class="mb-3">
        <label for="email" class="form-label " th:text="#{userprofile.email}"></label>
        <input type="email" class="form-control" id="email" name="email"
               th:placeholder="#{userprofile.emailplease}"
               th:value="${profile.email}"
               required>
        <div class="invalid-feedback" th:text="#{userprofile.emailAlert}"></div>
    </div>
    <div class="mb-3">
        <label for="phoneNumber" class="form-label" th:text="#{userprofile.phone}"></label>
        <input type="text" class="form-control" id="phoneNumber" name="phoneNumber"
               th:placeholder="#{userprofile.surnameplease}"
               th:value="${profile.phoneNumber}" required>
        <div class="invalid-feedback" th:text="#{userprofile.phoneAlert}"></div>
    </div>
    <button type="submit" class="btn btn-primary" th:text="#{userprofile.update}"></button>
</form>
<script>
    // Przykład prostego skryptu do weryfikacji formularza przed jego wysłaniem
    (function() {
      'use strict';
      window.addEventListener('load', function() {
        // Pobranie formularza do walidacji
        var forms = document.getElementsByClassName('needs-validation');
        // Pętla przez formularze i zapobieganie ich wysłaniu w przypadku znalezienia nieprawidłowych pól
        var validation = Array.prototype.filter.call(forms, function(form) {
          form.addEventListener('submit', function(event) {
            if (form.checkValidity() === false) {
              event.preventDefault();
              event.stopPropagation();
            }
            form.classList.add('was-validated');
          }, false);
        });
      }, false);
    })();
</script>
</body>
</html>
